import{d as A,u as I,P as i,o as r,E as u,B as t,D as o,G as C,L as X,M as Z,S as U,l as D,a3 as G,m as J,r as $,s as S,w as M,H as F,c as N,W,J as j,I as q}from"./vendor.44cd46a8.js";import{_ as w}from"./index.6afd7c72.js";import{m as x}from"./mdExcerpt.8d7de89f.js";import{d as ee}from"./dayjs.min.0373ae8b.js";const te=A({setup(){const e=I(),d=i({});return(()=>{e.dispatch("dashboard/getLoggedStatistics",{}).then(l=>{if(l.success&&l.data){const{blogCount:s=0,likeCount:c=0,readCount:p=0}=l.data;d.value={blogCount:s,likeCount:c,readCount:p}}})})(),{statistics:d}}}),T=e=>(X("data-v-3aeae166"),e=e(),Z(),e),se=T(()=>t("h3",{class:"header"},"\u4E2A\u4EBA\u6570\u636E\u603B\u89C8",-1)),ae={class:"user-statistics"},oe={class:"statistics-item"},ne=T(()=>t("span",{class:"icon-statistics icon-like-count"},null,-1)),re=T(()=>t("span",null,"\u6536\u83B7",-1)),ce={class:"count"},ie=T(()=>t("span",null,"\u8D5E",-1)),le={class:"statistics-item"},ue=T(()=>t("span",{class:"icon-statistics icon-read-count"},null,-1)),de={class:"count"},pe=T(()=>t("span",null,"\u6B21\u9605\u8BFB",-1)),_e={class:"statistics-item"},ve=T(()=>t("span",{class:"icon-statistics icon-article-count"},null,-1)),ge=T(()=>t("span",null,"\u6587\u7AE0",-1)),he={class:"count"},fe=T(()=>t("span",null,"\u7BC7",-1));function me(e,d,m,l,s,c){return r(),u(C,null,[se,t("div",ae,[t("div",oe,[ne,re,t("span",ce,o(e.statistics.likeCount),1),ie]),t("div",le,[ue,t("span",de,o(e.statistics.readCount),1),pe]),t("div",_e,[ve,ge,t("span",he,o(e.statistics.blogCount),1),fe])])],64)}var ye=w(te,[["render",me],["__scopeId","data-v-3aeae166"]]);const K={blogCount:"\u6587\u7AE0\u6570\u6392\u884C\u699C",readCount:"\u9605\u8BFB\u6392\u884C\u699C",likeCount:"\u70B9\u8D5E\u6392\u884C\u699C"},O={blogCount:"\u7BC7",readCount:"",likeCount:"\u8D5E"};const ke=A({props:{orderType:{type:String,default:"likeCount"}},setup(e){const d=I(),m=U();let l=!1;const s=i([]),c=i(1),p=i(10),y=i(0),_=i(null),k=i(null),a=i(!1),g=i(null),L=i(1),E=D(()=>{var v;const n=d.state.common.navTeamList||[];return!((v=n[0])==null?void 0:v.temp)&&n.unshift({team:null,category:null,temp:!0}),n}),z=D(()=>K[e.orderType]),H=D(()=>O[e.orderType]),B=n=>`icon-medal ${["icon-gold","icon-silver","icon-copper"][n]}`,P=n=>n/L.value*100,h=()=>{const n=["#f50","#2db7f5","#87d068","#108ee9"],v=Math.floor(Math.random()*4);return n[v]},f=n=>{m.push(`/post/${n.blogId}`)},b=(n=!1)=>{a.value=!0,n&&(c.value=1),d.dispatch("dashboard/getRankListInArticleDimension",{team:k.value||null,category:_.value||null,orderType:e.orderType,pageNo:c.value,pageSize:p.value}).then(v=>{if(a.value=!1,v.success&&v.data){const V=v.data.rankList||[];n&&(l=!1,s.value=[],G(()=>{const Y=g.value;Y&&(Y.scrollTop=0)}),L.value=V[0]&&V[0][e.orderType]),s.value.push(...V),y.value=v.data.totalCount||0}})},R=n=>{const v=E.value[n];k.value=v.team,_.value=v.category,b(!0)},Q=()=>{if(a.value||l)return;if(c.value*p.value>=y.value){l=!0,J.warning("\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86");return}const n=g.value;n.scrollHeight-n.scrollTop<=n.clientHeight+96&&(c.value+=1,b())};return b(!0),{rankList:s,articleListRef:g,tabList:E,activeTeam:k,activeCategory:_,isFetchData:a,onArticleListScroll:Q,onTabClick:R,getIconMedalClass:B,title:z,progressText:H,getPercent:P,mdExcerpt:x,dayjs:ee,getRandomColor:h,goBlogDetail:f}}}),Ce={class:"header"},$e={class:"article-rank-area"},Te={class:"rank-info"},Le={class:"article-info"},be={class:"article-title"},Se=["onClick"],Ee={class:"article-content"},Be={class:"article-other-info"},De={class:"article-author"},Me={class:"article-date"},Re={class:"article-progress"},Ae={key:1,style:{"text-align":"center","margin-top":"50px"}};function Ie(e,d,m,l,s,c){const p=$("a-tab-pane"),y=$("a-tabs"),_=$("a-tag"),k=$("a-progress");return r(),u(C,null,[t("h3",Ce,o(e.title),1),t("div",$e,[S(y,{onTabClick:e.onTabClick},{default:M(()=>[(r(!0),u(C,null,F(e.tabList,(a,g)=>(r(),N(p,{key:g,tab:a.team?`${a.team}${a.category}`:"\u5168\u90E8",disabled:e.isFetchData},null,8,["tab","disabled"]))),128))]),_:1},8,["onTabClick"]),t("div",{ref:"articleListRef",class:"article-list",onScroll:d[0]||(d[0]=(...a)=>e.onArticleListScroll&&e.onArticleListScroll(...a))},[e.rankList.length?(r(!0),u(C,{key:0},F(e.rankList,(a,g)=>(r(),u("div",{key:a.blogId,class:"article"},[t("div",Te,[g<3?(r(),u("span",{key:0,class:W(e.getIconMedalClass(g))},null,2)):(r(),u(C,{key:1},[j(o(g+1),1)],64))]),t("div",Le,[t("p",be,[t("span",{class:"title",onClick:L=>e.goBlogDetail(a)},o(a.title),9,Se),(r(!0),u(C,null,F(a.tags,(L,E)=>(r(),N(_,{color:e.getRandomColor(),class:"article-tag"},{default:M(()=>[j(o(L),1)]),_:2},1032,["color"]))),256))]),t("p",Ee,o(a.excerpt||e.mdExcerpt(a.__content,100)||"..."),1),t("p",Be,[t("span",De,"by "+o(a.author),1),t("span",Me,o(e.dayjs(a.date).format("YYYY-MM-DD")),1)])]),t("div",Re,[a[e.orderType]?(r(),N(k,{key:0,percent:e.getPercent(a[e.orderType])},{format:M(L=>[t("span",null,o(a[e.orderType]),1)]),_:2},1032,["percent"])):q("",!0)])]))),128)):(r(),u("div",Ae," \u6682\u65E0\u6570\u636E "))],544)])],64)}var Fe=w(ke,[["render",Ie],["__scopeId","data-v-7ad1cf2c"]]);const Ne=A({props:{orderType:{type:String,default:"blogCount"},progressType:{type:String,default:"circle"}},setup(e){const d=I(),m=U();let l=!1;const s=i([]),c=i(1),p=i(10),y=i(0),_=i(!1),k=i(null),a=i(1),g=D(()=>K[e.orderType]),L=D(()=>O[e.orderType]),E=h=>`icon-medal ${["icon-gold","icon-silver","icon-copper"][h]}`,z=h=>h/a.value*100,H=h=>{m.push(`/author/${h.um}/`)},B=(h=!1)=>{_.value=!0,h&&(c.value=1),d.dispatch("dashboard/getRankListInUserDimension",{orderType:e.orderType,pageNo:c.value,pageSize:p.value}).then(f=>{if(_.value=!1,f.success&&f.data){const b=f.data.rankList||[];h&&(l=!1,s.value=[],a.value=b[0]&&b[0][e.orderType],G(()=>{const R=k.value;R&&(R.scrollTop=0)})),s.value.push(...b),y.value=f.data.totalCount||0}})},P=h=>{if(_.value||l)return;if(c.value*p.value>=y.value){l=!0,J.warning("\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86");return}const f=k.value;f.scrollHeight-f.scrollTop<=f.clientHeight+66&&(c.value+=1,B())};return B(!0),{getRankList:B,isFetchData:_,rankList:s,goAnthorDetail:H,onUserListScroll:P,title:g,userListRef:k,getIconMedalClass:E,getPercent:z,progressText:L}}}),je={class:"header"},we={class:"rank-info"},ze={class:"user-info"},He={class:"user-base-info"},Pe={class:"user-name"},Ve={class:"user-um"},Ue={class:"user-department-info"},Ye={class:"user-progress"},Ge={key:1,style:{"text-align":"center","margin-top":"50px"}};function Je(e,d){const m=$("a-avatar"),l=$("a-progress");return r(),u(C,null,[t("h3",je,o(e.title),1),t("div",{ref:"userListRef",class:"user-list",onScroll:d[0]||(d[0]=(...s)=>e.onUserListScroll&&e.onUserListScroll(...s))},[e.rankList.length>0?(r(!0),u(C,{key:0},F(e.rankList,(s,c)=>(r(),u("div",{key:s.userId,class:"user"},[t("div",we,[c<3?(r(),u("span",{key:0,class:W(e.getIconMedalClass(c))},null,2)):(r(),u(C,{key:1},[j(o(c+1),1)],64))]),S(m,{class:"user-avatar",size:36,src:s.head_img,style:{backgroundColor:"#87d068"},onClick:p=>e.goAnthorDetail(s)},{default:M(()=>[j(o(s.name[0]),1)]),_:2},1032,["src","onClick"]),t("div",ze,[t("div",He,[t("span",Pe,o(s.name),1),t("span",Ve,o(s.um),1)]),t("div",Ue,o(s.department)+" "+o(s.team)+" "+o(s.duty),1)]),t("div",Ye,[s[e.orderType]?(r(),N(l,{key:0,type:e.progressType,percent:e.getPercent(s[e.orderType]),width:40},{format:M(p=>[t("span",null,o(s[e.orderType])+o(e.progressType==="circle"?e.progressText:""),1)]),_:2},1032,["type","percent"])):q("",!0)])]))),128)):(r(),u("div",Ge,"\u6682\u65E0\u6570\u636E"))],544)],64)}var We=w(Ne,[["render",Je],["__scopeId","data-v-e17ece5c"]]);const qe=A({components:{userStatistics:ye,articleRank:Fe,userRank:We},setup(){return I(),U(),{}}}),Ke={class:"page-admin-dashboard"},Oe={class:"rank-area"},Qe={class:"rank-left"},Xe={class:"rank-right"};function Ze(e,d,m,l,s,c){const p=$("user-statistics"),y=$("article-rank"),_=$("user-rank");return r(),u("div",Ke,[S(p),t("div",Oe,[t("div",Qe,[S(y,{orderType:"likeCount"})]),t("div",Xe,[S(_,{orderType:"blogCount",progressType:"circle"}),S(_,{orderType:"readCount",progressType:"circle"})])])])}var at=w(qe,[["render",Ze],["__scopeId","data-v-6674d264"]]);export{at as default};
